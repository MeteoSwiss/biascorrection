<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Quantile Mapping — qqmap • biascorrection</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Quantile Mapping — qqmap" />
<meta property="og:description" content="Computes bias correction with quantile mapping (i.e. additive 
 quantile correction). A short-hand for multiplicative (qqmap_mul) 
 quantile mapping is also provided. Furthermore, a quantile mapping approach 
 in which the algorithm moves on in jumps rather than sequantially along lead
 times is provided via fastqqmap and fastqqmap_mul, 
 respectively." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biascorrection</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/biascorrection.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/jonasbhend/biascorrection/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Quantile Mapping</h1>
    <small class="dont-index">Source: <a href='http://github.com/jonasbhend/biascorrection/blob/master/R/qqmap.R'><code>R/qqmap.R</code></a></small>
    <div class="hidden name"><code>qqmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes bias correction with quantile mapping (i.e. additive 
 quantile correction). A short-hand for multiplicative (<code>qqmap_mul</code>) 
 quantile mapping is also provided. Furthermore, a quantile mapping approach 
 in which the algorithm moves on in jumps rather than sequantially along lead
 times is provided via <code>fastqqmap</code> and <code>fastqqmap_mul</code>, 
 respectively.</p>
    </div>

    <pre class="usage"><span class='fu'>qqmap</span>(<span class='no'>fcst</span>, <span class='no'>obs</span>, <span class='kw'>fcst.out</span> <span class='kw'>=</span> <span class='no'>fcst</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0.01</span>, <span class='fl'>0.99</span>, <span class='fl'>0.01</span>),
  <span class='kw'>window</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>fcst</span>), <span class='fl'>31</span>), <span class='kw'>jump</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>multiplicative</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>lower.bound</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>anomalies</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>debias</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>smoothobs</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>smooth</span> <span class='kw'>=</span> <span class='no'>smoothobs</span>, <span class='kw'>span</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='fl'>91</span>/<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>fcst</span>), <span class='fl'>1</span>),
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>8</span>, <span class='no'>...</span>)

<span class='fu'>iqqmap</span>(<span class='no'>fcst</span>, <span class='no'>obs</span>, <span class='kw'>fcst.out</span> <span class='kw'>=</span> <span class='no'>fcst</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='no'>prob</span>, <span class='kw'>multiplicative</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>8</span>)

<span class='fu'>qqmap_mul</span>(<span class='no'>...</span>, <span class='kw'>multiplicative</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>fastqqmap</span>(<span class='no'>fcst</span>, <span class='kw'>window</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>fcst</span>), <span class='fl'>31</span>), <span class='kw'>jump</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='no'>window</span>, <span class='fl'>11</span>), <span class='no'>...</span>)

<span class='fu'>fastqqmap_mul</span>(<span class='no'>fcst</span>, <span class='kw'>window</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>fcst</span>), <span class='fl'>31</span>), <span class='kw'>jump</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='no'>window</span>, <span class='fl'>11</span>),
  <span class='kw'>multiplicative</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='fu'>qqmap_debias</span>(<span class='no'>...</span>, <span class='kw'>debias</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fcst</th>
      <td><p>n x m x k array of n lead times, m forecasts, of k ensemble 
members</p></td>
    </tr>
    <tr>
      <th>obs</th>
      <td><p>n x m matrix of veryfing observations</p></td>
    </tr>
    <tr>
      <th>fcst.out</th>
      <td><p>array of forecast values to which bias correction should be 
applied (defaults to <code>fcst</code>)</p></td>
    </tr>
    <tr>
      <th>prob</th>
      <td><p>quantiles for which quantile correction is estimated</p></td>
    </tr>
    <tr>
      <th>window</th>
      <td><p>width of window to be used for quantile mapping</p></td>
    </tr>
    <tr>
      <th>jump</th>
      <td><p>minimum number of days the moving quantile window jumps (see 
below)</p></td>
    </tr>
    <tr>
      <th>multiplicative</th>
      <td><p>logical, is quantile correction to be applied 
multiplicatively?</p></td>
    </tr>
    <tr>
      <th>lower.bound</th>
      <td><p>is used to truncate output if set (e.g. to zero for 
precipitation)</p></td>
    </tr>
    <tr>
      <th>anomalies</th>
      <td><p>logical, should quantile mapping be applied to forecast and 
observed anomalies (from forecast ensemble mean) only (see below)?</p></td>
    </tr>
    <tr>
      <th>debias</th>
      <td><p>logical, should quantile mapping be applied to anomalies from 
smoothed climatology (only additive)?</p></td>
    </tr>
    <tr>
      <th>smoothobs</th>
      <td><p>logical, should observation climatology be smoothed?</p></td>
    </tr>
    <tr>
      <th>smooth</th>
      <td><p>logical, should forecast climatology be smoothed?</p></td>
    </tr>
    <tr>
      <th>span</th>
      <td><p>the smoothing bandwidth (see <code><a href='https://rdrr.io/r/stats/loess.html'>loess</a></code>)</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>an integer between 1 and 9 selecting one of the nine quantile
algorithms detailed below to be used (see <code><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></code>).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments for compatibility with other bias correction 
methods</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The quantile mapping algorithm estimates quantile correction factors 
 for <code>q</code> quantiles. For each forecast value in <code>fcst.out</code>, the 
 percentile within which the value falls in the distribution of input 
 forecasts <code>fcst</code> is determined and the corresponding quantile 
 correction applied. For multiplicative quantile mapping 
 (<code>multiplicative = TRUE</code>), the bias corrected forecast 
 (<code>fcst.out</code>) is divided by the ratio of forecast to observed quantiles,
 whereas for additive quantile mapping <code>multiplicative = FALSE</code> (the
 default), the difference between the forecast and observed quantiles are
 subtracted from <code>fcst.out</code>.</p> 
<p>The quantile mapping is lead time dependent, parameter <code>window</code> is used
 to select the number of lead times on either side of the lead time that is 
 to be corrected to be included in the quantile estimation. For the begining
 and end of the series, the lead-time interval is kept constant, so that to
 estimate the quantile correction for the first lead time, the first
 <code>window</code> lead times are used. If <code>exact = FALSE</code>, the lead time
 dependent quantiles for the forecast are directly estimated from single lead
 times without the surrounding <code>window</code> lead times. This is a quick and
 dirty fix to speed up processing.</p>
    <h2 class="hasAnchor" id="de-biasing"><a class="anchor" href="#de-biasing"></a>De-biasing</h2>

    <p>If <code>debias = TRUE</code>, the quantile correction is 
 applied to the anomalies from the long-term lead-time dependent climatology 
 (from the observations and forecasts respectively). The quantile corrected 
 forecast anomalies are finally added to the observed climatology to produce 
 an approximately unbiased, quantile corrected forecast. If <code>smoothobs =
 TRUE</code> and/or <code>smooth = TRUE</code>, the lead-time dependent climatology of 
 the observations and/or forecasts are smoothed using a 
 <code><a href='https://rdrr.io/r/stats/loess.html'>loess</a></code> smoother with bandwidth <code>span</code>. Whether 
 there are use-cases for which such an <em>a priori</em> de-biasing is 
 beneficial is not obvious and needs further exploration.</p>
    <h2 class="hasAnchor" id="anomalies"><a class="anchor" href="#anomalies"></a>Anomalies</h2>

    <p>If <code>anomalies</code> is set, forecast and observed 
 anomalies are computed with reference to the forecast ensemble mean (the 
 signal) and the quantile correction is only applied to the anomalies with 
 the signal being left uncorrected. It is speculated that such an approach 
 may more explicitly reflect the skill / calibration relationship of 
 forecasts (i.e. the option has been implemented without theoretical 
 underpinning nor an existing use-case that illustrates the benefits of 
 applying quantile corrections as described in this paragraph ;-).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## initialise forcast observation pairs</span>
<span class='no'>nens</span> <span class='kw'>&lt;-</span> <span class='fl'>51</span>
<span class='no'>signal</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/outer.html'>outer</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>4</span>,<span class='kw'>length</span><span class='kw'>=</span><span class='fl'>215</span>)), <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>30</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>0.2</span>)), <span class='st'>'+'</span>) + <span class='fl'>2</span>
<span class='no'>fcst</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>raw</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>rgamma</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>signal</span>)*<span class='no'>nens</span>, <span class='kw'>shape</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>2</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span>(<span class='no'>signal</span>), <span class='no'>nens</span>)) *
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>signal</span>) * (<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>signal</span>)*<span class='no'>nens</span>) <span class='kw'>&gt;</span> <span class='fl'>0.1</span>))
<span class='no'>obs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>rgamma</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>signal</span>), <span class='kw'>shape</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>1</span>), <span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span>(<span class='no'>signal</span>)) *
  <span class='no'>signal</span> * (<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>signal</span>)) <span class='kw'>&gt;</span> <span class='fl'>0.3</span>)
<span class='no'>fcst</span>$<span class='no'>qqmap</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>biascorrection</span><span class='kw ns'>:::</span><span class='fu'>qqmap</span>(<span class='no'>fcst</span>$<span class='no'>raw</span>[,<span class='fl'>1</span>:<span class='fl'>20</span>,],
  <span class='no'>obs</span>[,<span class='fl'>1</span>:<span class='fl'>20</span>], <span class='kw'>fcst.out</span><span class='kw'>=</span><span class='no'>fcst</span>$<span class='no'>raw</span>, <span class='kw'>lower.bound</span><span class='kw'>=</span><span class='fl'>0</span>)
<span class='no'>fcst</span>$<span class='no'>qqmap_mul</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>biascorrection</span><span class='kw ns'>:::</span><span class='fu'>qqmap_mul</span>(<span class='no'>fcst</span>$<span class='no'>raw</span>[,<span class='fl'>1</span>:<span class='fl'>20</span>,],
  <span class='no'>obs</span>[,<span class='fl'>1</span>:<span class='fl'>20</span>], <span class='kw'>fcst.out</span><span class='kw'>=</span><span class='no'>fcst</span>$<span class='no'>raw</span>, <span class='kw'>lower.bound</span><span class='kw'>=</span><span class='fl'>0</span>)
<span class='no'>oprob</span> <span class='kw'>&lt;-</span> (<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='no'>obs</span>[,<span class='fl'>21</span>:<span class='fl'>30</span>]) - <span class='fl'>1</span>/<span class='fl'>3</span>) / (<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>obs</span>[,<span class='fl'>21</span>:<span class='fl'>30</span>]) + <span class='fl'>1</span>/<span class='fl'>3</span>)
<span class='no'>oldpar</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>no.readonly</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span>(<span class='no'>obs</span>[,<span class='fl'>21</span>:<span class='fl'>30</span>], <span class='kw'>from</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>80</span>, <span class='kw'>bw</span><span class='kw'>=</span><span class='fl'>1</span>), <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'n'</span>,
     <span class='kw'>main</span><span class='kw'>=</span><span class='st'>'Distribution in validation period'</span>)
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>fcst</span>)) <span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span>(<span class='no'>fcst</span><span class='kw'>[[</span><span class='no'>i</span>]][,<span class='fl'>21</span>:<span class='fl'>30</span>,<span class='fl'>1</span>], <span class='kw'>from</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>80</span>, <span class='kw'>bw</span><span class='kw'>=</span><span class='fl'>1</span>), <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='no'>i</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span>(<span class='no'>obs</span>[,<span class='fl'>21</span>:<span class='fl'>30</span>], <span class='kw'>from</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>to</span><span class='kw'>=</span><span class='fl'>80</span>, <span class='kw'>bw</span><span class='kw'>=</span><span class='fl'>1</span>), <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fl'>2</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span>(<span class='st'>'topright'</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>'Observations'</span>, <span class='st'>'No bias correction'</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>fcst</span>)[-<span class='fl'>1</span>]),
       <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>fcst</span>))), <span class='kw'>lty</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='no'>fcst</span>)), <span class='kw'>inset</span><span class='kw'>=</span><span class='fl'>0.05</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>(<span class='no'>obs</span>[,<span class='fl'>21</span>:<span class='fl'>30</span>], <span class='kw'>type</span><span class='kw'>=</span><span class='fl'>8</span>, <span class='no'>oprob</span>),
  <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>(<span class='no'>fcst</span><span class='kw'>[[</span><span class='fl'>1</span>]][,<span class='fl'>21</span>:<span class='fl'>30</span>,], <span class='kw'>type</span><span class='kw'>=</span><span class='fl'>8</span>, <span class='no'>oprob</span>),
  <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'l'</span>, <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>'Observed quantiles'</span>,
  <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>'Forecast quantiles'</span>,
  <span class='kw'>main</span><span class='kw'>=</span><span class='st'>'Out-of-sample validation for qqmap'</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>), <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fl'>2</span>)</div><div class='input'><span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>2</span>:<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>fcst</span>)) <span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>(<span class='no'>obs</span>[,<span class='fl'>21</span>:<span class='fl'>30</span>], <span class='kw'>type</span><span class='kw'>=</span><span class='fl'>8</span>, <span class='no'>oprob</span>),
  <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>(<span class='no'>fcst</span><span class='kw'>[[</span><span class='no'>i</span>]][,<span class='fl'>21</span>:<span class='fl'>30</span>,], <span class='kw'>type</span><span class='kw'>=</span><span class='fl'>8</span>, <span class='no'>oprob</span>), <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='no'>i</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span>(<span class='st'>'topleft'</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>'No bias correction'</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>fcst</span>)[-<span class='fl'>1</span>]), <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='kw'>along</span><span class='kw'>=</span><span class='no'>fcst</span>), <span class='kw'>inset</span><span class='kw'>=</span><span class='fl'>0.05</span>)</div><div class='img'><img src='qqmap-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='no'>oldpar</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jonas Bhend.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


